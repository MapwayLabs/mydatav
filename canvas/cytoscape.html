<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>cytoscape</title>
  <script src="../lib/cytoscape.min.js"></script>
  <script src="../data/dmc-node-links.js"></script>

  <script src="./cyto-lib//cola.min.js"></script>
  <script src="./cyto-lib/cytoscape-cola.js"></script>

  <script src="https://unpkg.com/layout-base/layout-base.js"></script>
	<script src="https://unpkg.com/avsdf-base/avsdf-base.js"></script>
  <script src="./cyto-lib/cytoscape-avsdf.js"></script>

  <!-- <script src="https://unpkg.com/layout-base/layout-base.js"></script> -->
	<script src="https://unpkg.com/avsdf-base/avsdf-base.js"></script>
	<script src="https://unpkg.com/cose-base/cose-base.js"></script>
	<script src="https://unpkg.com/cytoscape-graphml/cytoscape-graphml.js"></script>
	<script src="https://raw.githack.com/iVis-at-Bilkent/cytoscape.js-layvo/unstable/cytoscape-layvo.js"></script>
  <script src="./cyto-lib/cytoscape-cise.js"></script>

  <!-- <script src="https://unpkg.com/layout-base/layout-base.js"></script> -->
  <!-- <script src="https://unpkg.com/cose-base/cose-base.js"></script> -->
  <script src="./cyto-lib/cytoscape-cose-bilkent.js"></script>

  <script src="./cyto-lib/dagre.js"></script>
  <script src="./cyto-lib/cytoscape-dagre.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/elkjs@0.3.0/lib/elk.bundled.js"></script>
  <script src="./cyto-lib/cytoscape-elk.js"></script>

  <script src="./cyto-lib/cytoscape-euler.js"></script>

  <script src="https://unpkg.com/numeric/numeric-1.2.6.js"></script>
  <script src="https://unpkg.com/cytoscape-layout-utilities/cytoscape-layout-utilities.js"></script>
  <script src="./cyto-lib/cytoscape-fcose.js"></script>

  <script src="https://unpkg.com/klayjs@0.4.1/klay.js"></script>
	<script src="./cyto-lib/cytoscape-klay.js"></script>

  <script src="./cyto-lib/cytoscape-ngraph.forcelayout.js"></script>

  <!-- <script src="./cyto-lib/polywas-layout.js"></script> -->
 
  <script src="https://unpkg.com/weaverjs@1.2.0/dist/weaver.min.js"></script>
  <script src="./cyto-lib/cytoscape-spread.js"></script>

  <script src="./cyto-lib/springy.js"></script>
  <script src="./cyto-lib/cytoscape-springy.js"></script>

  <style>
  #layout {
    position: absolute;
  }
  </style>
</head>
<body>
  <div id="cy" style="position:absolute;left:0;right:0;top:0;bottom:0;width:100%;height:100%;"></div>
  <div id="layout">
  <form action="">
   <select name="layoutSelect" id="layout-select">
      <option value="random">随机布局</option>
      <option value="grid">网格布局</option>
      <option value="circle">圆形布局</option>
      <option value="concentric">同心布局</option>
      <option value="breadthfirst">广度布局</option>
      <option value="cose">cose布局</option>
      <option value="cola">cola布局</option>
      <option value="avsdf">avsdf布局</option>
      <option value="cise">cise布局</option>
      <option value="cose-bilkent">cose-bilkent布局</option>
      <option value="dagre">dagre布局</option>
      <option value="elk">elk布局</option>
      <option value="euler">euler布局</option>
      <option value="fcose">fcose布局</option>
      <option value="klay">klay布局</option>
      <option value="cytoscape-ngraph.forcelayout">forcelayout布局</option>
      <!-- <option value="polywas">polywas布局</option> -->
      <option value="spread">spread布局</option>
      <option value="springy">springy布局</option>
   </select>
   <select name="lineSelect" id="line-select">
      <option value="straight">直线</option>
      <option value="unbundled-bezier">曲线</option>
   </select>
  </form>
  </div>
  <script>

  var LayoutOptions = {
    'random': {},
    'grid': {},
    'circle': {},
    'concentric': {},
    'breadthfirst': {},
    'cose': {},
    'cola': {},
    'avsdf': {},
    'cise': {},
    'cose-bilkent': {},
    'dagre': {},
    'elk': {},
    'euler': {},
    'fcose': {},
    'klay': {
      klay: {
        aspectRatio: 10,
        direction: 'RIGHT',
        spacing: 40
      }
    },
    'cytoscape-ngraph.forcelayout': {},
    'polywas': {},
    'spread': {},
    'springy': {}
  };

  var nodes = data.node_meta.map(d => {
    d.id = d.key;
    return {
      data: d
    };
  });

  var edges = data.line_meta.map(d => {
    d.id = d.__gohashid;
    d.source = d.from;
    d.target = d.to;
    return {
      data: d
    };
  });

  var cy = cytoscape({

  container: document.getElementById('cy'),

  elements: [ // flat array of nodes and edges
  ...nodes,
  ...edges
  ],

  layout: {
    name: 'random'
  },

  // so we can see the ids
  style: [
    {
      selector: 'node',
      style: {
        // 'label': 'data(title)',
        'shape': 'round-rectangle',
        'background-color': '#fff',
        'background-image': './cyto-lib/img/preview.svg',
        'border-width': 1,
        'border-color': '#ccc',
        'width': 50,
        'height': 50
      }
    },
    {
      selector: 'edge',
      style: {
         "curve-style": "straight",
         'target-arrow-shape': 'triangle',
         'line-color': '#A2C5FF',
         'line-style': 'dashed',
         'target-arrow-color': '#A2C5FF'
      }
    }
  ]

});

  var selectEle = document.getElementById('layout-select');
  var lineSelectEle = document.getElementById('line-select');
  selectEle.addEventListener('change', e => {
    var name = e.target.value;
    var options = LayoutOptions[name];
    options.name = name;
    cy.layout(options).run();
  });
  lineSelectEle.addEventListener('change', e => {
    cy.style()
    .selector('edge')
    .style({
      "curve-style": e.target.value
    })
    .update(); // indicate the end of your new stylesheet so that it can be updated on element
  });
  </script>
</body>
</html>