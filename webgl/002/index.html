<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>threejs三维流线图</title>
    <script src="../../lib/threejs/three.js"></script>
    <script src="../../lib/threejs/js/controls/OrbitControls.js"></script>
    <script src="./dist/threejsmap.js"></script>
    <script src="../../lib/jquery.min.js"></script>
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            height: 100%;
        }
    </style>
</head>

<body>
    <div id="threemap" style="position: relative; width: 100%; height: 100%;"></div>
    <script>
        // ./china_province.json  geo-china-beijing.json world2 countriesgeo.json
        $.getJSON('../../data/countriesgeo.json', function (data) {
            // map.setView();
            let mapOptions = {
                type: 'plane',
                region: 'world',
                crs: 'EPSG:3857'
            }
            const map = new TMap.ThreeMap('threemap', mapOptions);
            var geoOptions = {
                isExtrude: true
            };
            window.geojsonLayer = new TMap.GeoJSONLayer(data, geoOptions);
            map.addLayer(window.geojsonLayer);
            map.setView(window.geojsonLayer.getBounds());
            $.getJSON('../../data/flyline.json', function(fdata) {
                let flOptions = {
                    // geojsonLayer: window.geojsonLayer
                    lineStyle: {
                        show: false,
                        color: '#f00',
                        opacity: 0.1,
                         width: 1
                    },
                    effect: {
                        show: true,
                        period: 6, // 尾迹特效的周期
                        constantSpeed: 40, // 尾迹特效是否是固定速度，设置后忽略period值
                        trailWidth: 4, // 尾迹宽度（暂时无效）
                        trailLength: 0.6, // 尾迹长度，范围 0-1，为线条长度百分比
                        trailColor: '#00f', // 尾迹颜色，默认跟线颜色相同
                        trailOpacity: 0.9 // 尾迹不透明度，默认跟线相同
                    }
                };
                let fl = new TMap.FlyLineLayer(fdata, window.geojsonLayer, flOptions);
                map.addLayer(fl);
            });
            // window.barLayer = new BarChartLayer(Data, {
            //     isNormalizeData: false
            // }, window.geojsonLayer.getData())
            // map.addLayer(window.barLayer)
        });
    </script>
</body>

</html>