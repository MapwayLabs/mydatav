<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>3d-force-graph</title>
    <script src="../../lib/threejs/three.js"></script>
    <script src="../../lib/d3/d3.js"></script>
    <script src="./3d-force-graph-1.45.6/dist/3d-force-graph.js"></script>
    <style>
        body {
            margin: 0;
        }
    </style>
</head>

<body>
    <div id="3d-graph"></div>

    <script>
        // Random tree
        const N = 100;
        const gData = {
            nodes: [...Array(N).keys()].map(i => ({
                id: i
            })),
            links: [...Array(N).keys()]
                .filter(id => id)
                .map(id => ({
                    source: id,
                    target: Math.round(Math.random() * (id - 1))
                }))
        };

        const Graph = ForceGraph3D({
            controlType: 'orbit'
        })
            (document.getElementById('3d-graph'))
            .graphData(gData)
            .forceEngine('d3')
        //  .forceEngine('ngraph')
            .enableNodeDrag(true)
        //  .cooldownTicks(0)
            .cooldownTime(500)
            .numDimensions(3)
            .nodeRelSize(10)
            .linkColor(0xFF0000)
            .linkWidth(1)
            .linkOpacity(0.4)
            // .linkMaterial(function() {
            //     return new THREE.LineBasicMaterial({
            //         color: 0xFF0000,
            //         linewidth: 1
            //     });
            // })
            .linkThreeObject(function(link) {
                const geometry = new THREE.BufferGeometry();
                const material = new THREE.LineBasicMaterial( { 
                    color: 0x1F3D7A, 
                    linewidth: 1, 
                    linecap: 'round' } );
                material.transparent = true;
                material.opacity = 0.5;
                const positions = [];
                positions.push(link.source.x, link.source.y, link.source.z);
                positions.push(link.target.x, link.target.y, link.target.z);
                geometry.addAttribute( 'position', new THREE.Float32BufferAttribute( positions, 3 ) );
                return new THREE.Line( geometry, material );
            })
            .nodeOpacity(1)
            .d3Force('collision', d3.forceCollide(20))
            .d3Force('collision', d3.forceCollide(20))
        //  .linkDirectionalArrowLength(15)
        //  .linkDirectionalArrowRelPos(1)
        //  .linkCurvature(1)
        // const orbitControl = Graph.controls();
    </script>
</body>

</html>